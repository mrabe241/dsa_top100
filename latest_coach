import json
import re

PAT = re.compile(r"^ABC-(\d+)$")
counter = 4000

def remap_abc(s: str) -> str:
    global counter
    m = PAT.match(s or "")
    if not m:
        return s
    new_val = f"ABC-{counter}"
    counter += 1
    return new_val

def walk_remap(obj):
    if isinstance(obj, dict):
        return {k: walk_remap(v) for k, v in obj.items()}
    elif isinstance(obj, list):
        return [walk_remap(v) for v in obj]
    elif isinstance(obj, str):
        return remap_abc(obj)
    return obj

with open("data.json", "r", encoding="utf-8") as f:
    data = json.load(f)

updated = walk_remap(data)

with open("data_updated.json", "w", encoding="utf-8") as f:
    json.dump(updated, f, indent=2, ensure_ascii=False)
